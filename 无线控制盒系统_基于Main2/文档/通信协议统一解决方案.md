# é€šä¿¡åè®®ç»Ÿä¸€è§£å†³æ–¹æ¡ˆ

## ğŸš¨ **é—®é¢˜è¯Šæ–­**

### å½“å‰é—®é¢˜
- **433MHzé¥æ§å™¨**ï¼šèƒ½æ­£å¸¸æ¥æ”¶æ•°æ®ï¼Œä½¿ç”¨ASKè°ƒåˆ¶åè®®
- **æ— çº¿æ§åˆ¶ç›’**ï¼šå‘é€Serial2ä¸²å£æ•°æ®ï¼Œæ ¼å¼ä¸º `FD [å‘½ä»¤] [æ•°æ®1] [æ•°æ®2] [æ•°æ®3] [æ•°æ®4] DF`
- **åè®®ä¸åŒ¹é…**ï¼šä¸¤ç§è®¾å¤‡ä½¿ç”¨ä¸åŒçš„é€šä¿¡åè®®ï¼Œæ— æ³•æ­£å¸¸äº¤äº’

### æ ¹æœ¬åŸå› 
1. **433MHzé¥æ§å™¨**ï¼šä½¿ç”¨RCSwitchåº“ï¼Œå‘é€ASKè°ƒåˆ¶ä¿¡å·
2. **æ— çº¿æ§åˆ¶ç›’**ï¼šä½¿ç”¨Serial2ä¸²å£ï¼Œå‘é€æ ¼å¼åŒ–æ•°æ®åŒ…
3. **åè®®å·®å¼‚**ï¼šASK vs ä¸²å£é€šä¿¡ï¼Œæ•°æ®æ ¼å¼å®Œå…¨ä¸åŒ

## ğŸ”§ **è§£å†³æ–¹æ¡ˆ**

### æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ä½¿ç”¨RCSwitchåè®®ï¼ˆæ¨èï¼‰

å°†æ— çº¿æ§åˆ¶ç›’æ”¹ä¸ºä½¿ç”¨RCSwitchåº“ï¼Œä¸433MHzé¥æ§å™¨ä½¿ç”¨ç›¸åŒçš„åè®®ã€‚

#### ä¿®æ”¹æ— çº¿æ§åˆ¶ç›’ä»£ç 

```cpp
#include <RCSwitch.h>

RCSwitch mySwitch = RCSwitch();

void setup() {
  // åˆå§‹åŒ–RCSwitch
  mySwitch.enableTransmit(16);  // ä½¿ç”¨Pin 16ä½œä¸ºå‘é€å¼•è„š
  mySwitch.enableReceive(17);   // ä½¿ç”¨Pin 17ä½œä¸ºæ¥æ”¶å¼•è„š
  
  Serial.println("=== æ— çº¿æ§åˆ¶ç›’RCSwitchåˆå§‹åŒ– ===");
  Serial.println("å‘é€å¼•è„š: 16");
  Serial.println("æ¥æ”¶å¼•è„š: 17");
  Serial.println("åè®®: ASKè°ƒåˆ¶");
  Serial.println("===============================");
}

// å‘é€æ•°æ®ï¼ˆä½¿ç”¨RCSwitchåè®®ï¼‰
void sendWirelessData(uint32_t data) {
  if (!Val.isPaired) {
    return;
  }
  
  // å‘é€24ä½æ•°æ®
  mySwitch.send(data, 24);
  
  Serial.print("å‘é€æ•°æ®: 0x");
  Serial.println(data, HEX);
}

// å‘é€é…å¯¹è¯·æ±‚
void sendPairingRequest() {
  // é…å¯¹è¯·æ±‚æ ¼å¼: [è®¾å¤‡ID] [å‘½ä»¤] [å‚æ•°]
  uint32_t pairData = (Val.deviceId << 16) | (0x0E << 8) | 0x00;
  mySwitch.send(pairData, 24);
  
  Serial.println(">>> é…å¯¹è¯·æ±‚å·²å‘é€");
}

// å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®
void handleReceivedData() {
  if (mySwitch.available()) {
    uint32_t receivedData = mySwitch.getReceivedValue();
    mySwitch.resetAvailable();
    
    if (receivedData != 0) {
      // è§£ææ•°æ®
      uint8_t deviceId = (receivedData >> 16) & 0xFF;
      uint8_t command = (receivedData >> 8) & 0xFF;
      uint8_t parameter = receivedData & 0xFF;
      
      Serial.print("æ”¶åˆ°æ•°æ®: 0x");
      Serial.print(receivedData, HEX);
      Serial.print(" (è®¾å¤‡ID: 0x");
      Serial.print(deviceId, HEX);
      Serial.print(", å‘½ä»¤: 0x");
      Serial.print(command, HEX);
      Serial.print(", å‚æ•°: 0x");
      Serial.print(parameter, HEX);
      Serial.println(")");
      
      // å¤„ç†å‘½ä»¤
      processCommand(deviceId, command, parameter);
    }
  }
}
```

#### ä¿®æ”¹ä¸»æ§åˆ¶å™¨ä»£ç 

```cpp
#include <RCSwitch.h>

RCSwitch mySwitch = RCSwitch();

void setup() {
  // åˆå§‹åŒ–RCSwitch
  mySwitch.enableTransmit(16);  // ä½¿ç”¨Pin 16ä½œä¸ºå‘é€å¼•è„š
  mySwitch.enableReceive(17);   // ä½¿ç”¨Pin 17ä½œä¸ºæ¥æ”¶å¼•è„š
  
  Serial.println("=== ä¸»æ§åˆ¶å™¨RCSwitchåˆå§‹åŒ– ===");
  Serial.println("å‘é€å¼•è„š: 16");
  Serial.println("æ¥æ”¶å¼•è„š: 17");
  Serial.println("åè®®: ASKè°ƒåˆ¶");
  Serial.println("=============================");
}

// å‘é€æ•°æ®
void sendWirelessData(uint32_t data) {
  mySwitch.send(data, 24);
  
  Serial.print("å‘é€æ•°æ®: 0x");
  Serial.println(data, HEX);
}

// å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®
void handleReceivedData() {
  if (mySwitch.available()) {
    uint32_t receivedData = mySwitch.getReceivedValue();
    mySwitch.resetAvailable();
    
    if (receivedData != 0) {
      // è§£ææ•°æ®
      uint8_t deviceId = (receivedData >> 16) & 0xFF;
      uint8_t command = (receivedData >> 8) & 0xFF;
      uint8_t parameter = receivedData & 0xFF;
      
      Serial.print("æ”¶åˆ°æ•°æ®: 0x");
      Serial.print(receivedData, HEX);
      Serial.print(" (è®¾å¤‡ID: 0x");
      Serial.print(deviceId, HEX);
      Serial.print(", å‘½ä»¤: 0x");
      Serial.print(command, HEX);
      Serial.print(", å‚æ•°: 0x");
      Serial.print(parameter, HEX);
      Serial.println(")");
      
      // å¤„ç†å‘½ä»¤
      processCommand(deviceId, command, parameter);
    }
  }
}
```

### æ–¹æ¡ˆ2ï¼šç»Ÿä¸€ä½¿ç”¨Serial2åè®®

å°†433MHzé¥æ§å™¨æ”¹ä¸ºä½¿ç”¨Serial2ä¸²å£é€šä¿¡ã€‚

#### ä¿®æ”¹433MHzé¥æ§å™¨ä»£ç 

```cpp
void setup() {
  Serial2.begin(9600);
  
  Serial.println("=== 433MHzé¥æ§å™¨Serial2åˆå§‹åŒ– ===");
  Serial.println("ä¸²å£: Serial2");
  Serial.println("æ³¢ç‰¹ç‡: 9600bps");
  Serial.println("åè®®: FD [å‘½ä»¤] [æ•°æ®1] [æ•°æ®2] [æ•°æ®3] [æ•°æ®4] DF");
  Serial.println("=================================");
}

// å‘é€æ•°æ®ï¼ˆä½¿ç”¨Serial2åè®®ï¼‰
void sendWirelessData(byte command, byte data1, byte data2, byte data3, byte data4) {
  Serial2.write(0xFD);  // å¸§å¤´
  Serial2.write(command);
  Serial2.write(data1);
  Serial2.write(data2);
  Serial2.write(data3);
  Serial2.write(data4);
  Serial2.write(0xDF);  // å¸§å°¾
  
  Serial2.flush();
  
  Serial.print("å‘é€æ•°æ®: FD ");
  Serial.print(command, HEX);
  Serial.print(" ");
  Serial.print(data1, HEX);
  Serial.print(" ");
  Serial.print(data2, HEX);
  Serial.print(" ");
  Serial.print(data3, HEX);
  Serial.print(" ");
  Serial.print(data4, HEX);
  Serial.println(" DF");
}
```

## ğŸ“‹ **æ¨èå®æ–½æ­¥éª¤**

### æ­¥éª¤1ï¼šé€‰æ‹©æ–¹æ¡ˆ
**æ¨èä½¿ç”¨æ–¹æ¡ˆ1ï¼ˆRCSwitchåè®®ï¼‰**ï¼Œå› ä¸ºï¼š
- 433MHzé¥æ§å™¨å·²ç»å·¥ä½œæ­£å¸¸
- RCSwitchåº“æ›´ç¨³å®š
- å®ç°æ›´ç®€å•

### æ­¥éª¤2ï¼šä¿®æ”¹æ— çº¿æ§åˆ¶ç›’
1. æ·»åŠ RCSwitchåº“
2. ä¿®æ”¹å‘é€å‡½æ•°
3. ä¿®æ”¹æ¥æ”¶å¤„ç†
4. æµ‹è¯•åŸºæœ¬é€šä¿¡

### æ­¥éª¤3ï¼šä¿®æ”¹ä¸»æ§åˆ¶å™¨
1. æ·»åŠ RCSwitchåº“
2. ä¿®æ”¹å‘é€å‡½æ•°
3. ä¿®æ”¹æ¥æ”¶å¤„ç†
4. æµ‹è¯•é…å¯¹åŠŸèƒ½

### æ­¥éª¤4ï¼šæµ‹è¯•éªŒè¯
1. æµ‹è¯•é…å¯¹åŠŸèƒ½
2. æµ‹è¯•æ•°æ®å‘é€
3. æµ‹è¯•å‘½ä»¤å¤„ç†
4. æµ‹è¯•ç¨³å®šæ€§

## ğŸ”§ **å…·ä½“ä¿®æ”¹æ–‡ä»¶**

### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼š
1. `æ— çº¿æ§åˆ¶ç›’ç³»ç»Ÿ_åŸºäºMain2/æ— çº¿æ§åˆ¶ç›’/WirelessControlBox/WirelessControlBox.ino`
2. `æ— çº¿æ§åˆ¶ç›’ç³»ç»Ÿ_åŸºäºMain2/ä¸»æ§åˆ¶å™¨/Main_Wireless_Master/Main_Wireless_Master.ino`

### éœ€è¦æ·»åŠ çš„åº“ï¼š
```cpp
#include <RCSwitch.h>
```

## ğŸ“Š **åè®®å¯¹æ¯”**

| ç‰¹æ€§ | RCSwitchåè®® | Serial2åè®® |
|------|-------------|-------------|
| è°ƒåˆ¶æ–¹å¼ | ASK | ä¸²å£ |
| æ•°æ®æ ¼å¼ | 24ä½æ•´æ•° | FD [å‘½ä»¤] [æ•°æ®1] [æ•°æ®2] [æ•°æ®3] [æ•°æ®4] DF |
| åº“ä¾èµ– | RCSwitch | æ—  |
| ç¨³å®šæ€§ | é«˜ | ä¸­ |
| å®ç°å¤æ‚åº¦ | ä½ | ä¸­ |
| å…¼å®¹æ€§ | ä¸433MHzé¥æ§å™¨å…¼å®¹ | éœ€è¦ä¿®æ”¹é¥æ§å™¨ |

## ğŸ¯ **é¢„æœŸç»“æœ**

å®æ–½æ–¹æ¡ˆ1åï¼š
1. **æ— çº¿æ§åˆ¶ç›’**å’Œ**ä¸»æ§åˆ¶å™¨**ä½¿ç”¨ç›¸åŒçš„RCSwitchåè®®
2. **433MHzé¥æ§å™¨**å¯ä»¥æ­£å¸¸ä¸ä¸¤ä¸ªè®¾å¤‡é€šä¿¡
3. **é…å¯¹åŠŸèƒ½**æ­£å¸¸å·¥ä½œ
4. **æ•°æ®åŒæ­¥**ç¨³å®šå¯é 
5. **å‘½ä»¤ä¼ è¾“**æ— é”™è¯¯

## ğŸš€ **ç«‹å³è¡ŒåŠ¨**

1. **é€‰æ‹©æ–¹æ¡ˆ1**ï¼ˆRCSwitchåè®®ï¼‰
2. **ä¿®æ”¹æ— çº¿æ§åˆ¶ç›’ä»£ç **
3. **ä¿®æ”¹ä¸»æ§åˆ¶å™¨ä»£ç **
4. **æµ‹è¯•é€šä¿¡åŠŸèƒ½**
5. **éªŒè¯é…å¯¹å’Œæ•°æ®ä¼ è¾“**

è¿™æ ·å°±èƒ½è§£å†³åè®®ä¸åŒ¹é…çš„é—®é¢˜ï¼Œè®©æ‰€æœ‰è®¾å¤‡ä½¿ç”¨ç»Ÿä¸€çš„é€šä¿¡åè®®ï¼
