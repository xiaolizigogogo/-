# 硬件连接故障排除指南

## 主控制器无法接收数据问题排查

### 问题现象
- 主控制器的 `wirelessSerial.available()` 总是返回0
- 控制盒模块闪烁（说明控制盒在发送数据）
- 用USB-TTL可以接收到控制盒发送的数据
- 主控制器没有任何反应

### 可能的原因和解决方案

#### 1. 引脚连接错误（最常见）

**检查项目：**
- 确认433MHz模块的TXD连接到Arduino的引脚28（RX）
- 确认433MHz模块的RXD连接到Arduino的引脚29（TX）
- 确认433MHz模块的VCC连接到Arduino的5V
- 确认433MHz模块的GND连接到Arduino的GND

**重要提醒：**
```
433MHz模块 TXD → Arduino引脚28（接收）
433MHz模块 RXD → Arduino引脚29（发送）
```
这是**交叉连接**，不是直连！

#### 2. 模块供电问题

**检查项目：**
- 用万用表测量433MHz模块的VCC引脚电压是否为5V
- 检查GND连接是否牢固
- 确认模块上的电源指示灯是否亮起

#### 3. 模块损坏

**测试方法：**
1. 将主控制器的433MHz模块拆下
2. 将控制盒的433MHz模块连接到主控制器
3. 如果控制盒的模块在主控制器上能正常工作，说明主控制器的模块损坏

#### 4. 引脚冲突

**检查项目：**
- 确认引脚28和29没有被其他功能占用
- 检查是否有其他代码定义了这些引脚
- 确认没有硬件串口或其他功能使用这些引脚

#### 5. 波特率不匹配

**检查项目：**
- 确认433MHz模块的波特率设置为9600
- 确认代码中 `wirelessSerial.begin(9600)` 的波特率设置正确

### 详细排查步骤

#### 步骤1：基础连接检查
```
1. 断开电源
2. 检查所有连接线是否牢固
3. 用万用表测量连接点是否导通
4. 重新连接电源
```

#### 步骤2：模块功能测试
```
1. 用USB-TTL连接433MHz模块
2. 发送测试数据：FD 0E 00 00 00 00 DF
3. 观察模块指示灯是否闪烁
4. 如果指示灯不闪烁，模块可能损坏
```

#### 步骤3：引脚功能测试
```
1. 将433MHz模块连接到Arduino的引脚28和29
2. 上传测试代码
3. 观察串口输出
4. 如果仍然没有数据，检查引脚定义
```

#### 步骤4：代码验证
```
1. 确认代码中使用了正确的引脚定义
2. 确认SoftwareSerial初始化正确
3. 确认数据读取逻辑正确
```

### 测试代码

#### 简单的433MHz模块测试代码
```cpp
#include <SoftwareSerial.h>

SoftwareSerial wirelessSerial(28, 29); // RX=28, TX=29

void setup() {
  Serial.begin(115200);
  wirelessSerial.begin(9600);
  
  Serial.println("=== 433MHz模块测试 ===");
  Serial.println("RX=28, TX=29");
  Serial.println("波特率=9600");
  Serial.println("=====================");
}

void loop() {
  // 检查是否有数据
  if (wirelessSerial.available() > 0) {
    Serial.print("收到数据: ");
    while (wirelessSerial.available()) {
      uint8_t data = wirelessSerial.read();
      Serial.print("0x");
      if (data < 0x10) Serial.print("0");
      Serial.print(data, HEX);
      Serial.print(" ");
    }
    Serial.println();
  }
  
  delay(100);
}
```

### 常见错误

#### 错误1：直连而不是交叉连接
```
错误连接：
433MHz模块 TXD → Arduino引脚29（TX）
433MHz模块 RXD → Arduino引脚28（RX）

正确连接：
433MHz模块 TXD → Arduino引脚28（RX）
433MHz模块 RXD → Arduino引脚29（TX）
```

#### 错误2：引脚定义冲突
```
错误：使用已被占用的引脚
正确：使用空闲的引脚28和29
```

#### 错误3：供电不足
```
错误：使用3.3V供电
正确：使用5V供电
```

### 联系支持

如果按照以上步骤仍然无法解决问题，请提供以下信息：
1. 硬件连接照片
2. 串口输出日志
3. 使用的Arduino板型号
4. 433MHz模块型号
5. 测试结果
