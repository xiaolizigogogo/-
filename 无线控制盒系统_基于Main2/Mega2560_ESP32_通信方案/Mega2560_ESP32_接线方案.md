# Mega2560 + ESP32 模块通信方案

## 系统架构
```
Mega2560主控制器 ←→ ESP32模块 ←→ ESP32模块 ←→ Mega2560从控制器
```

## 接线方案

### ESP32模块引脚定义
- **VCC**: 3.3V (注意：ESP32是3.3V设备)
- **GND**: 地线
- **EN**: 使能引脚 (可选，接3.3V)
- **GPIO0**: 启动模式选择 (正常运行时悬空)
- **GPIO1**: TX (发送)
- **GPIO3**: RX (接收)
- **GPIO2**: 状态指示LED (可选)

### Mega2560主控制器接线
```
ESP32模块    →    Mega2560
VCC         →    3.3V
GND         →    GND
GPIO1(TX)   →    RX1 (引脚19)
GPIO3(RX)   →    TX1 (引脚18)
GPIO2       →    数字引脚2 (状态指示)
```

### Mega2560从控制器接线
```
ESP32模块    →    Mega2560
VCC         →    3.3V
GND         →    GND
GPIO1(TX)   →    RX1 (引脚19)
GPIO3(RX)   →    TX1 (引脚18)
GPIO2       →    数字引脚2 (状态指示)
```

## 电源要求
- ESP32模块需要3.3V供电
- 电流需求：约200-500mA
- 建议使用外部3.3V稳压器或ESP32专用电源模块

## 通信协议
- 波特率：115200
- 数据格式：8N1 (8位数据，无校验，1位停止位)
- 协议：JSON格式数据交换

## 注意事项
1. **电压兼容性**：ESP32是3.3V设备，Mega2560是5V设备
2. **电平转换**：Mega2560的5V输出需要电平转换才能连接ESP32
3. **电源稳定性**：确保3.3V电源稳定，建议使用专用电源模块
4. **接地**：确保两个设备共地连接
5. **线长**：建议使用短连接线，减少干扰

## 推荐硬件
- ESP32-WROOM-32 开发板
- 3.3V稳压模块 (如AMS1117-3.3)
- 电平转换模块 (如TXS0108E)
- 杜邦线和面包板
