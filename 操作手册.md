# 多电机舵机控制系统操作手册

## 1. 系统安装

### 1.1 硬件安装

#### 1.1.1 主控板连接
1. **电源连接**
   - 将5V电源连接到Arduino的VIN引脚
   - 将GND连接到Arduino的GND引脚
   - 确保电源能够提供足够的电流（建议2A以上）

2. **舵机连接**
   - 舵机信号线连接到Pin 9
   - 舵机电源线连接到5V电源
   - 舵机地线连接到GND

3. **电机连接**
   - 电机1：PWM引脚连接到Pin 7，方向引脚连接到Pin 4, 5, 6
   - 电机2：PWM引脚连接到Pin 8，方向引脚连接到Pin 4, 5, 6
   - 电机3：PWM引脚连接到Pin 10，方向引脚连接到Pin 4, 5, 6
   - 电机电源连接到外部电源（根据电机规格）

#### 1.1.2 编码器连接
按照以下表格连接7个旋转编码器：

| 编码器 | CLK引脚 | DT引脚 | 电源 | 地线 |
|--------|---------|--------|------|------|
| 编码器0 | Pin 2 | Pin 11 | 5V | GND |
| 编码器1 | Pin 3 | Pin 12 | 5V | GND |
| 编码器2 | Pin 21 | Pin 13 | 5V | GND |
| 编码器3 | Pin 20 | Pin 14 | 5V | GND |
| 编码器4 | Pin 19 | Pin 15 | 5V | GND |
| 编码器5 | Pin 18 | Pin 16 | 5V | GND |
| 编码器6 | Pin 23 | Pin 17 | 5V | GND |

#### 1.1.3 按键连接
按照以下表格连接7个按键：

| 按键 | 引脚 | 功能 |
|------|------|------|
| 按键1 | Pin 31 | 参数保存 |
| 按键2 | Pin 33 | 舵机开关 |
| 按键3 | Pin 35 | 停留时间模式切换 |
| 按键4 | Pin 37 | 舵机开关（备用） |
| 按键5 | Pin 39 | 电机1开关 |
| 按键6 | Pin 41 | 电机2开关 |
| 按键7 | Pin 43 | 电机3开关 |

#### 1.1.4 数码管连接
连接3组数码管显示模块：

**数码管1（显示左右停留时间）**
- 数据引脚：Pin 36
- 时钟引脚：Pin 34
- 锁存引脚：Pin 32
- 电源：5V
- 地线：GND

**数码管2（显示摆动幅度和速度）**
- 数据引脚：Pin 26
- 时钟引脚：Pin 24
- 锁存引脚：Pin 22
- 电源：5V
- 地线：GND

**数码管3（显示电机速度）**
- 数据引脚：Pin 46
- 时钟引脚：Pin 44
- 锁存引脚：Pin 42
- 电源：5V
- 地线：GND

### 1.2 软件安装

#### 1.2.1 Arduino IDE设置
1. 下载并安装Arduino IDE（推荐版本1.8.x或更高）
2. 安装必要的库文件：
   - Servo库（Arduino内置）
   - ArduinoJson库（版本6.x）
   - EEPROM库（Arduino内置）

#### 1.2.2 代码上传
1. 将所有源文件复制到Arduino项目文件夹
2. 打开Arduino IDE
3. 选择正确的板型和端口
4. 编译并上传代码到Arduino

## 2. 系统启动

### 2.1 上电启动
1. **检查连接**：确认所有硬件连接正确
2. **上电**：接通电源
3. **观察显示**：数码管应显示当前参数值
4. **串口监控**：打开串口监视器（115200波特率）查看启动信息

### 2.2 参数初始化
系统启动时会自动：
- 从EEPROM读取保存的参数
- 初始化所有编码器值
- 设置舵机和电机的初始状态
- 显示当前参数到数码管

## 3. 基本操作

### 3.1 舵机控制

#### 3.1.1 舵机开关
- **开启舵机**：按下按键2（Pin 33）
- **关闭舵机**：再次按下按键2
- **状态指示**：舵机开启时，数码管2会显示摆动幅度和速度

#### 3.1.2 参数调节
1. **摆动幅度调节**
   - 旋转编码器0（Pin 2/11）
   - 数码管2左侧显示幅度值（0-99）
   - 实际角度范围：0°-180°

2. **摆动速度调节**
   - 旋转编码器1（Pin 3/12）
   - 数码管2右侧显示速度值（0-99）
   - 数值越大，摆动越慢

3. **停留时间调节**
   - 旋转编码器2（Pin 21/13）
   - 数码管1显示停留时间
   - 时间范围：0-25秒

4. **中位点调节**
   - 旋转编码器3（Pin 20/14）
   - 调节舵机的中心位置
   - 脉冲范围：1100μs-2000μs

#### 3.1.3 停留时间模式
- **模式切换**：按下按键3（Pin 35）
- **模式说明**：
  - 模式0：调节左端停留时间
  - 模式1：调节右端停留时间
  - 模式2：退出调节模式

### 3.2 电机控制

#### 3.2.1 电机开关
- **电机1**：按下按键5（Pin 39）
- **电机2**：按下按键6（Pin 41）
- **电机3**：按下按键7（Pin 43）

#### 3.2.2 速度调节
1. **电机1速度**：旋转编码器4（Pin 19/15）
2. **电机2速度**：旋转编码器5（Pin 18/16）
3. **电机3速度**：旋转编码器6（Pin 23/17）
4. **速度显示**：数码管3显示当前电机速度

### 3.3 参数保存
- **保存操作**：按下按键1（Pin 31）
- **保存内容**：所有当前参数值
- **保存确认**：串口会输出保存的参数值
- **自动恢复**：下次启动时自动加载保存的参数

## 4. 显示说明

### 4.1 数码管显示格式

#### 数码管1（左右停留时间）
- **显示格式**：`L.R.`（左停留时间.右停留时间）
- **示例**：`5.3.`表示左端停留5秒，右端停留3秒

#### 数码管2（摆动幅度和速度）
- **显示格式**：`AS`（幅度速度）
- **示例**：`4590`表示幅度45，速度90

#### 数码管3（电机速度）
- **显示格式**：`S`（速度值）
- **示例**：`80`表示电机速度80

### 4.2 状态指示
- **舵机运行**：数码管2有数值变化
- **电机运行**：数码管3显示速度值
- **参数保存**：串口输出保存信息

## 5. 高级操作

### 5.1 参数微调
1. **精确调节**：缓慢旋转编码器进行精细调节
2. **参数验证**：通过数码管显示确认参数值
3. **实时测试**：在调节过程中观察执行器响应

### 5.2 模式组合
1. **舵机+电机组合**：同时控制舵机和多个电机
2. **不同速度组合**：为不同电机设置不同速度
3. **时间同步**：调节停留时间与电机运行时间同步

### 5.3 故障恢复
1. **参数重置**：长按按键1可重置所有参数
2. **系统重启**：断电重启可恢复默认设置
3. **手动调节**：通过编码器重新调节所有参数

## 6. 维护保养

### 6.1 日常检查
1. **连接检查**：定期检查所有连接是否牢固
2. **电源检查**：确认电源电压稳定
3. **机械检查**：检查舵机和电机的机械连接

### 6.2 清洁保养
1. **表面清洁**：定期清洁控制面板
2. **编码器清洁**：清洁编码器表面，防止灰尘影响
3. **散热检查**：确保电机和舵机有足够散热

### 6.3 软件维护
1. **参数备份**：定期保存重要参数设置
2. **固件更新**：关注软件版本更新
3. **日志记录**：记录异常情况和解决方案

## 7. 安全注意事项

### 7.1 电气安全
- 确保电源电压符合要求
- 避免短路和过载
- 使用合适的保险丝保护

### 7.2 机械安全
- 确保机械部件安装牢固
- 避免过载运行
- 定期检查机械磨损

### 7.3 操作安全
- 操作前确认系统状态
- 避免在运行中强制停止
- 保持操作环境整洁

## 8. 故障排除

### 8.1 常见故障及解决方法

| 故障现象 | 可能原因 | 解决方法 |
|----------|----------|----------|
| 舵机不动作 | 电源不足、连接错误 | 检查电源和连接 |
| 电机不转 | PWM信号错误、方向信号错误 | 检查PWM和方向引脚 |
| 编码器无响应 | 连接松动、中断配置错误 | 检查连接和中断设置 |
| 数码管不显示 | 74HC595连接错误 | 检查数据、时钟、锁存引脚 |
| 参数不保存 | EEPROM损坏、存储空间不足 | 检查EEPROM状态 |

### 8.2 调试步骤
1. **硬件检查**：确认所有连接正确
2. **电源检查**：测量各点电压
3. **信号检查**：用示波器检查PWM信号
4. **软件调试**：通过串口输出调试信息

## 9. 技术支持

### 9.1 联系方式
- **技术支持**：系统开发者
- **文档更新**：定期更新操作手册
- **问题反馈**：及时反馈使用中的问题

### 9.2 更新记录
- **v1.0**：初始版本
- 后续版本将在此处记录更新内容

---

**操作手册版本**：v1.0  
**适用系统版本**：v1.0  
**最后更新**：2024年  
**维护人员**：系统开发者 